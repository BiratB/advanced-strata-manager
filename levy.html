<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Generate Levy Notice</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      .levy-container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        text-align: center;
      }
      .generate-btn {
        background-color: #1e88e5;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        text-decoration: none;
        display: inline-block;
        margin: 20px 0;
      }
      .generate-btn:hover {
        background-color: #1565c0;
      }
      .info-box {
        background-color: #e3f2fd;
        border: 1px solid #bbdefb;
        border-radius: 4px;
        padding: 15px;
        margin: 20px 0;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="navbar">
      <ul>
        <li><a href="index.html">🏠 Home</a></li>
        <li><a href="login.html">🔐 Login</a></li>
        <li><a href="dashboard.html">📊 Dashboard</a></li>
        <li><a href="submit.html">📬 Maintenance</a></li>
        <li><a href="levy.html">📋 Levy Notice</a></li>
        <li><a href="roll.html">📋 Strata Roll</a></li>
        <li><a href="email.html">📧 Send Email</a></li>
      </ul>
    </nav>
    <p>Click the button below to generate and view a levy notice as PDF.</p>
    <a
      href="https://strata-backend.onrender.com/api/generate-levy.php"
      target="_blank"
    >
      <button>Generate Levy PDF</button>
    </a>
  </body>
</html>

    <div class="levy-container">
      <h2>Generate Levy Notice</h2>
    <header>
      
      <div class="info-box">
        <h3>📄 What's included in the levy notice:</h3>
        <ul>
          <li>Quarterly levy amounts for each unit</li>
          <li>Payment due dates and methods</li>
          <li>Contact information for inquiries</li>
          <li>Breakdown of common area expenses</li>
        </ul>
      </div>
      
      <button class="generate-btn" onclick="generateLevy()">Generate Levy PDF</button>
      
      <div id="levy-result" style="margin-top: 20px; display: none;"></div>
    </div>
    
    <script>
      async function generateLevy() {
        const resultDiv = document.getElementById('levy-result');
        const btn = document.querySelector('.generate-btn');
        
        btn.disabled = true;
        btn.textContent = 'Generating...';
        resultDiv.style.display = 'block';
        resultDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating levy notice...';
        
        try {
          const data = await window.strataAPI.generateLevy();
          resultDiv.innerHTML = `
            <div style="background: #d4edda; padding: 20px; border-radius: 8px; border: 1px solid #c3e6cb;">
              <div style="text-align: center; margin-bottom: 15px;">
                <i class="fas fa-file-pdf" style="font-size: 3rem; color: #dc3545;"></i>
                <h3 style="color: #155724; margin: 10px 0;">Levy Notice Generated!</h3>
              </div>
              <div style="text-align: left; color: #155724;">
                <p><strong>Quarter:</strong> ${data.quarter}</p>
                <p><strong>Total Amount:</strong> $${data.totalAmount.toLocaleString()}</p>
                <p><strong>Units Covered:</strong> ${data.units.length}</p>
                <p><strong>Due Date:</strong> ${data.units[0].dueDate}</p>
              </div>
              <div style="text-align: center; margin-top: 15px;">
                <button onclick="downloadPDF()" style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
                  <i class="fas fa-download"></i> Download PDF
                </button>
              </div>
            </div>
          `;
        } catch (error) {
          resultDiv.innerHTML = `
            <div style="background: #f8d7da; padding: 20px; border-radius: 8px; border: 1px solid #f5c6cb; color: #721c24;">
              <i class="fas fa-exclamation-triangle"></i> Error generating levy notice: ${error.message}
            </div>
          `;
        } finally {
          btn.disabled = false;
          btn.textContent = 'Generate Levy PDF';
        }
      }
      
      function downloadPDF() {
        alert('📄 PDF download would start here!\n\nIn a production system, this would download the actual levy notice PDF file.');
      }